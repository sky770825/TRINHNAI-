# LINE é ç´„ç³»çµ±å¾Œå°ç®¡ç†æŒ‡å—

## ðŸ“‹ ç®¡ç†æ–¹å¼

æ‰€æœ‰è¨­å®šéƒ½å¯ä»¥ç›´æŽ¥åœ¨ [Supabase Dashboard](https://supabase.com/dashboard/project/cnzqtuuegdqwkgvletaa/editor) çš„ Table Editor ä¸­ç®¡ç†ã€‚

---

## 1ï¸âƒ£ æœå‹™é …ç›®ç®¡ç† (`service_settings` è¡¨)

### å¦‚ä½•æ–°å¢ž/ç·¨è¼¯æœå‹™

1. é€²å…¥ Supabase â†’ Table Editor â†’ `service_settings`
2. é»žæ“Š "Insert row" æ–°å¢žæœå‹™ï¼Œæˆ–é»žæ“Šç¾æœ‰è¡Œç·¨è¼¯

### æ¬„ä½èªªæ˜Ž

| æ¬„ä½ | èªªæ˜Ž | ç¯„ä¾‹ |
|------|------|------|
| `service_id` | æœå‹™å”¯ä¸€IDï¼ˆè‹±æ–‡ï¼‰ | `nail`, `lash`, `tattoo` |
| `name` | æœå‹™åç¨±ï¼ˆå«è¡¨æƒ…ç¬¦è™Ÿï¼‰ | `ðŸ’… ç¾Žç”²æœå‹™` |
| `description` | æœå‹™æè¿° | `å‡è† æŒ‡ç”² \| å…‰ç™‚æŒ‡ç”² \| æŒ‡ç”²å½©ç¹ª` |
| `price_range` | åƒ¹æ ¼ç¯„åœ | `NT$ 150 - 990` |
| `image_url` | æœå‹™åœ–ç‰‡ç¶²å€ | `https://images.unsplash.com/...` |
| `is_active` | æ˜¯å¦å•Ÿç”¨ | `true` / `false` |
| `sort_order` | æŽ’åºï¼ˆæ•¸å­—è¶Šå°è¶Šå‰é¢ï¼‰ | `1`, `2`, `3` |

### ðŸ–¼ï¸ åœ–ç‰‡ä¾†æºæŽ¨è–¦

- **Unsplash**ï¼šhttps://unsplash.com/
- **Pexels**ï¼šhttps://www.pexels.com/
- æœå°‹é—œéµå­—ï¼šnail art, eyelash extension, eyebrow tattoo, waxing

---

## 2ï¸âƒ£ åˆ†åº—è¨­å®šç®¡ç† (`store_settings` è¡¨)

### å¦‚ä½•æ–°å¢ž/ç·¨è¼¯åˆ†åº—

1. é€²å…¥ Supabase â†’ Table Editor â†’ `store_settings`
2. é»žæ“Š "Insert row" æ–°å¢žåˆ†åº—ï¼Œæˆ–é»žæ“Šç¾æœ‰è¡Œç·¨è¼¯

### æ¬„ä½èªªæ˜Ž

| æ¬„ä½ | èªªæ˜Ž | ç¯„ä¾‹ |
|------|------|------|
| `store_id` | åˆ†åº—å”¯ä¸€IDï¼ˆè‹±æ–‡ï¼‰ | `yuanhua`, `zhongfu` |
| `name` | åˆ†åº—åç¨± | `ä¸­å£¢å…ƒåŒ–åº—` |
| `address` | åˆ†åº—åœ°å€ | `ä¸­å£¢å€å…ƒåŒ–è·¯XXè™Ÿ` |
| `opening_time` | é–‹å§‹ç‡Ÿæ¥­æ™‚é–“ | `09:00` |
| `closing_time` | çµæŸç‡Ÿæ¥­æ™‚é–“ | `22:00` |
| `time_slot_duration` | é ç´„æ™‚æ®µé–“éš”ï¼ˆåˆ†é˜ï¼‰ | `60` |
| `available_days` | ç‡Ÿæ¥­æ—¥ï¼ˆ0=æ—¥, 1=ä¸€...6=å…­ï¼‰ | `["1","2","3","4","5","6","0"]` |
| `is_active` | æ˜¯å¦å•Ÿç”¨ | `true` / `false` |

### ðŸ’¡ ç‡Ÿæ¥­æ—¥è¨­å®šç¯„ä¾‹

- é€±ä¸€åˆ°é€±äº”ï¼š`["1","2","3","4","5"]`
- å…¨é€±ç‡Ÿæ¥­ï¼š`["0","1","2","3","4","5","6"]`
- åƒ…é€±æœ«ï¼š`["0","6"]`

---

## 3ï¸âƒ£ é ç´„ç®¡ç† (`line_bookings` è¡¨)

### æŸ¥çœ‹æ‰€æœ‰é ç´„

1. é€²å…¥ Supabase â†’ Table Editor â†’ `line_bookings`
2. å¯ä»¥ä¾æ—¥æœŸã€ç‹€æ…‹ç¯©é¸

### é ç´„ç‹€æ…‹èªªæ˜Ž

| ç‹€æ…‹ | èªªæ˜Ž |
|------|------|
| `pending` | å¾…ç¢ºèª |
| `confirmed` | å·²ç¢ºèª |
| `cancelled` | å·²å–æ¶ˆ |
| `completed` | å·²å®Œæˆ |

### å¦‚ä½•ç¢ºèªé ç´„

1. æ‰¾åˆ°è¦ç¢ºèªçš„é ç´„è¨˜éŒ„
2. ä¿®æ”¹ä»¥ä¸‹æ¬„ä½ï¼š
   - `status` â†’ `confirmed`
   - `confirmed_at` â†’ ç•¶å‰æ™‚é–“ï¼ˆä¾‹å¦‚ï¼š`2026-01-11 15:30:00+00`ï¼‰
   - `confirmed_by` â†’ æ‚¨çš„åå­—ï¼ˆä¾‹å¦‚ï¼š`admin`ï¼‰
3. é»žæ“Š Save

### ðŸ“Š åŒ¯å‡ºé ç´„è³‡æ–™

1. åœ¨ Table Editor ä¸­é»žæ“Šå³ä¸Šè§’çš„ "..." 
2. é¸æ“‡ "Export CSV"
3. å³å¯ä¸‹è¼‰ Excel å¯é–‹å•Ÿçš„æª”æ¡ˆ

---

## 4ï¸âƒ£ å°éŽ–æ™‚æ®µç®¡ç† (`booking_blocks` è¡¨)

### å¦‚ä½•å°éŽ–ç‰¹å®šæ™‚æ®µ

ç”¨æ–¼è¨­å®šä¸å¯é ç´„çš„æ™‚æ®µï¼ˆä¾‹å¦‚ï¼šåº—ä¼‘æ—¥ã€ç‰¹æ®Šæ´»å‹•ç­‰ï¼‰

1. é€²å…¥ Supabase â†’ Table Editor â†’ `booking_blocks`
2. é»žæ“Š "Insert row" æ–°å¢žå°éŽ–

### æ¬„ä½èªªæ˜Ž

| æ¬„ä½ | èªªæ˜Ž | ç¯„ä¾‹ |
|------|------|------|
| `store_id` | åˆ†åº—ID | `yuanhua` |
| `block_date` | å°éŽ–æ—¥æœŸ | `2026-01-20` |
| `block_time` | å°éŽ–æ™‚æ®µ | `14:00` |
| `reason` | å°éŽ–åŽŸå› ï¼ˆé¸å¡«ï¼‰ | `åº—ä¼‘` / `å…§éƒ¨è¨“ç·´` |

### ðŸ’¡ æ‰¹é‡å°éŽ–æŠ€å·§

å¦‚æžœè¦å°éŽ–æ•´å¤©ï¼Œéœ€è¦ç‚ºæ¯å€‹æ™‚æ®µéƒ½æ–°å¢žä¸€ç­†è¨˜éŒ„ã€‚

---

## 5ï¸âƒ£ SQL å¿«é€Ÿæ“ä½œ

### æ‰¹é‡å°éŽ–æ•´å¤©

```sql
-- å°éŽ– 2026-01-20 æ•´å¤©ï¼ˆyuanhua åº—ï¼‰
INSERT INTO booking_blocks (store_id, block_date, block_time, reason)
SELECT 
  'yuanhua',
  '2026-01-20',
  hour || ':00',
  'åº—ä¼‘æ—¥'
FROM generate_series(9, 21) AS hour;
```

### æŸ¥è©¢æœ¬é€±é ç´„çµ±è¨ˆ

```sql
SELECT 
  booking_date,
  status,
  COUNT(*) as count
FROM line_bookings
WHERE booking_date >= CURRENT_DATE 
  AND booking_date < CURRENT_DATE + INTERVAL '7 days'
GROUP BY booking_date, status
ORDER BY booking_date;
```

### æŸ¥è©¢å¾…ç¢ºèªé ç´„

```sql
SELECT 
  user_name,
  phone,
  service,
  store,
  booking_date,
  booking_time,
  created_at
FROM line_bookings
WHERE status = 'pending'
ORDER BY booking_date, booking_time;
```

---

## ðŸ”” LINE é€šçŸ¥åŠŸèƒ½ï¼ˆå»ºè­°é–‹ç™¼ï¼‰

å¦‚æžœéœ€è¦åœ¨ç¢ºèªé ç´„æ™‚è‡ªå‹•ç™¼é€ LINE é€šçŸ¥çµ¦ç”¨æˆ¶ï¼Œå¯ä»¥ï¼š

1. åœ¨ Supabase Functions ä¸­å»ºç«‹ä¸€å€‹æ–°å‡½æ•¸
2. ä½¿ç”¨ Database Triggers åœ¨é ç´„ç‹€æ…‹æ”¹è®Šæ™‚è‡ªå‹•è§¸ç™¼
3. é€éŽ LINE Messaging API ç™¼é€ç¢ºèªè¨Šæ¯

---

## ðŸ“± å¸¸è¦‹å•é¡Œ

### Q: å¦‚ä½•æ›´æ”¹æœå‹™åœ–ç‰‡ï¼Ÿ
A: åœ¨ `service_settings` è¡¨ä¸­ä¿®æ”¹ `image_url` æ¬„ä½ç‚ºæ–°çš„åœ–ç‰‡ç¶²å€ã€‚

### Q: å¦‚ä½•æ–°å¢žæ–°çš„åˆ†åº—ï¼Ÿ
A: åœ¨ `store_settings` è¡¨ä¸­æ–°å¢žä¸€ç­†è¨˜éŒ„ï¼Œè¨­å®šå¥½æ‰€æœ‰å¿…è¦æ¬„ä½ã€‚

### Q: é ç´„æ™‚æ®µé–“éš”å¯ä»¥æ”¹å—Žï¼Ÿ
A: å¯ä»¥ï¼Œåœ¨ `store_settings` è¡¨ä¸­ä¿®æ”¹ `time_slot_duration` æ¬„ä½ï¼ˆå–®ä½ï¼šåˆ†é˜ï¼‰ã€‚

### Q: å¦‚ä½•é¿å…é‡è¤‡é ç´„ï¼Ÿ
A: ç³»çµ±æœƒè‡ªå‹•æª¢æŸ¥è©²æ™‚æ®µæ˜¯å¦å·²è¢«é ç´„æˆ–å°éŽ–ï¼Œä¸æœƒè®“ç”¨æˆ¶é ç´„å·²æ»¿çš„æ™‚æ®µã€‚

---

## ðŸŽ¯ ä¸‹ä¸€æ­¥å»ºè­°

1. **è¨­å®šå¯¦éš›çš„æœå‹™åœ–ç‰‡**ï¼šä½¿ç”¨æ‚¨åº—å…§çš„å¯¦éš›ç…§ç‰‡
2. **èª¿æ•´ç‡Ÿæ¥­æ™‚é–“**ï¼šæ ¹æ“šå¯¦éš›ç‡Ÿæ¥­æ™‚é–“ä¿®æ”¹åˆ†åº—è¨­å®š
3. **æ¸¬è©¦é ç´„æµç¨‹**ï¼šåœ¨ LINE ä¸­è¼¸å…¥ã€Œé ç´„ã€æ¸¬è©¦å®Œæ•´æµç¨‹
4. **å®šæœŸæª¢æŸ¥é ç´„**ï¼šæ¯å¤©æŸ¥çœ‹ `line_bookings` è¡¨ç¢ºèªé ç´„

---

éœ€è¦ä»»ä½•å”åŠ©ï¼Œè«‹éš¨æ™‚è©¢å•ï¼ ðŸŽ‰
